#!/bin/sh

#
# This file was generated by Chef.
# Do NOT modify this file by hand.
#

exec 2>&1
cd <%= @options[:remote_fs] %>
<% limits = node['jenkins']['executor']['ulimits'] %>
<% if limits && !limits.empty? %>
ulimit <% limits.each { |option, value| %>-<%= option %> <%= value %> <% } %>
<% end %>
exec chpst -u <%= ([@options[:user]] + @options[:groups]).join(':') %> \
  env HOME=<%= @options[:remote_fs] %> \
  JENKINS_HOME=<%= @options[:remote_fs] %> \
  <%= @options[:java_bin] %> \
<%- if @options[:jvm_options] -%>
  <%= @options[:jvm_options] %> \
<%- end -%>
  -jar <%= @options[:slave_jar] %> \
<%- if @options[:jnlp_secret] -%>
  -secret <%= @options[:jnlp_secret] %> \
<%- end -%>
  -jnlpUrl <%= @options[:jnlp_url] %>
